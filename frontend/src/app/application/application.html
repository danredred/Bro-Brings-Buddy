<mat-card
  [class]="`application ${app().status.toLowerCase()}`"
  appearance="outlined"
>
  <mat-card-header>
    <app-user-profile mat-card-avatar [username]="app().about" />

    <mat-card-title>{{app().about}}</mat-card-title>
    <mat-card-subtitle>#{{app().id}}</mat-card-subtitle>

    <mat-card-subtitle>{{app().status.toLowerCase()}}</mat-card-subtitle>
  </mat-card-header>
  <mat-card-content class="card-content">
    <mat-card-subtitle>
      {{app().type === 'TOMEMBER'? 'To Member' : 'To Admin'}}
    </mat-card-subtitle>
    <mat-card-subtitle>{{app().created | date }}</mat-card-subtitle>

    <div class="row-contianer">
      <label>Submitter</label>
      <app-user [username]="app().submitter" />
    </div>

    <mat-accordion>
      <mat-expansion-panel hideToggle>
        <mat-expansion-panel-header>
          <mat-panel-title> Approvers </mat-panel-title>
          @if(app().status==='PENDING'){
          <mat-panel-description [style.gap]="'3px'">
            <label>{{approveCount()}}/{{approvalNeeded()}}</label>
            <mat-progress-bar
              mode="determinate"
              [value]="100*approveCount()/approvalNeeded()"
            ></mat-progress-bar> </mat-panel-description
          >}
        </mat-expansion-panel-header>
        @for (user of app().approvers; track $index) {
        <app-user [username]="user" />
        }
      </mat-expansion-panel>
    </mat-accordion>
  </mat-card-content>
  @if(app().status==='PENDING' && (isAdmin()||isSubmitter())){
  <mat-card-actions>
    @if(allowVotes() && isAdmin()){
    <button
      matButton
      (click)="action.emit({id:app().id,action:(isAproving()?'DEAPROVE':'APROVE')})"
    [matTooltip]="isAproving()?'deaprove':'aprove'">
      {{(isAproving())?'❌':'✅'}}</button
    >} @if(isSubmitter()){
    <button matButton matTooltip="close application" (click)="action.emit({id:app().id,action:'CLOSE'})">
      🗑️
    </button>
    }
  </mat-card-actions>
  }
</mat-card>
